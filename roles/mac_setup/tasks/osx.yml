- shell: defaults read com.apple.finder AppleShowAllFiles
  ignore_errors: True 
  register: hiddenfiles

- name: Allowing finder to see all hidden files
  shell: "defaults write com.apple.finder AppleShowAllFiles YES; killall Finder"
  when: hiddenfiles.stdout != "YES"

- name: Get shell we are currently using
  shell: echo $SHELL
  register: current_shell

- name: "Set shell to {{ default_shell }}"
  shell: "chsh -s {{ default_shell }}"
  when:
    - default_shell is defined
    - default_shell not in current_shell.stdout

- name: Ensure our user is in the wheel group
  shell: "dscl . -append /Groups/wheel GroupMembership {{ lookup('env','USER') }}"
  become: yes 

- name: Set our KeyRepeat Time
  shell: defaults write NSGlobalDomain KeyRepeat -int 1

- name: Set out Key Delay Time
  shell: defaults read NSGlobalDomain InitialKeyRepeat -int 12

